#![allow(dead_code)]
use once_cell::sync::Lazy;
///! Offsets and AOB scan patterns to locate certain function in Xrd
use sigscan::SigScan;

/// BattleState::ControlBattleObject(state *)
pub static FN_CONTROL_BATTLE_OBJECT: Lazy<SigScan> = Lazy::new(|| {
    SigScan::new_yara_style(concat!(
        "6a ff 68 ?? ?? ?? ?? 64 a1 ?? ?? ?? ?? 5? 81",
        "e? ?? ?? ?? ?? a1 ?? ?? ?? ?? 33 ?? 89 ?? ?? ??",
        "?? ?? ?? 5? 5? 5? 5? a1 ?? ?? ?? ?? 33 ?? 5? 8d",
        "?? ?? ?? ?? ?? ?? 64 a3 ?? ?? ?? ?? 8b ?? 6a ??",
        "8d ?? ?? ?? e8 ?? ?? ?? ?? 8d ?? ?? ?? ?? ?? c7",
        "84 ?? ?? ?? ?? ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? 8d",
        "?? ?? ?? ?? ?? e8 ?? ?? ?? ??"
    ))
});

/// BBSAnalyzeExe
pub const FN_LOAD_BBSCRIPT: Lazy<SigScan> = Lazy::new(|| {
    SigScan::new_yara_style(concat!(
        "5? 8b ?? 83 e? ?? 6a ?? 68 ?? ?? ?? ?? 64 a1 ?? ?? ?? ?? 5?",
        "83 e? ?? a1 ?? ?? ?? ?? 33 ?? 89 ?? ?? ?? 5? 5? 5? a1 ?? ??",
        "?? ?? 33 ?? 5? 8d ?? ?? ?? 64 a3 ?? ?? ?? ?? 8b ?? ?? 8b ??",
        "89 ?? 8b ?? 83 c? ?? 8b ?? 8d ?? ?? 89 ?? ?? 8d ?? ?? 83 c?",
        "?? 89 ?? ?? 89 ?? ?? 85 ?? 74 ?? 6a ?? 6a ?? e8 ?? ?? ?? ??",
        "83 c? ?? 89 ?? ?? ?? c7 44 ?? ?? ?? ?? ?? ?? 85 ?? 74 ?? 5?",
        "8b ?? e8 ?? ?? ?? ??"
    ))
});

/// AREDGameInfo_Battle::UpdateBattle(state *)
pub const FN_UPDATE_BATTLE: Lazy<SigScan> = Lazy::new(|| {
    SigScan::new_yara_style(concat!(
        "6a ?? 68 ?? ?? ?? ?? 64 a1 ?? ?? ?? ?? 5? 83 e? ?? a1 ",
        "?? ?? ?? ?? 33 ?? 89 ?? ?? ?? 5? 5? 5? 5? a1 ?? ?? ?? ",
        "?? 33 ?? 5? 8d ?? ?? ?? ?? ?? ?? 64 a3 ?? ?? ?? ?? 8b ",
        "?? 89 ?? ?? ?? e8 ?? ?? ?? ?? 85 ?? 74 ?? 6a ?? e8 ?? ",
        "?? ?? ?? 83 c? ?? 8b ?? ?? ?? ?? ?? 8b ?? ?? ?? ?? ?? ",
        "8b ?? ?? ?? ?? ?? 33 ?? 3b ?? 74 ?? 8b ?? ?? ?? ?? ?? ",
        "83 e? ?? 89 ?? ?? ?? eb ?? 89 ?? ?? ?? 8d ?? ?? c7 44 ",
        "?? ?? ?? ?? ?? ?? 39 ?? ?? ?? ?? ?? 74 ?? 8b ?? ?? ?? ",
        "?? ?? 8b ?? ?? ?? ?? ?? 8b ?? ?? ?? ?? ?? 8b ?? 5? 8d ",
        "?? ?? ?? 5? 5? 5? 5? 8b ?? 89 ?? ?? ?? e8"
    ))
});

pub const FN_BOM_ROUNDANDEASYRESETINITIALIZE: Lazy<SigScan> = Lazy::new(|| {
    SigScan::new_yara_style(concat!(
        "81 e? ?? ?? ?? ?? a1 ?? ?? ?? ?? 33 ?? 89 ?? ?? ?? ?? ?? ?? 5? 5? 33 ?? 5? 8b ?? 5? ",
        "89 ?? ?? ?? ?? ?? 89 ?? ?? ?? ?? ?? 89 ?? ?? ?? ?? ?? 66 89 ?? ?? ?? ?? ?? e8 ?? ?? ",
        "?? ?? 8b ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? 3c ?? 74 ?? 39 ?? ?? ?? ?? ?? 75 ?? e8 ?? ?? ",
        "?? ?? 8b ?? e8 ?? ?? ?? ?? 85 ?? 75 ?? e8 ?? ?? ?? ?? 85 ?? 75 ?? a1 ?? ?? ?? ?? 8b ",
        "?? ?? ?? ?? ??"
    ))
});

pub const FN_CREATE_OBJECT_WITH_ARG: Lazy<SigScan> = Lazy::new(|| {
    SigScan::new_yara_style(concat!(
        "81 e? ?? ?? ?? ?? a1 ?? ?? ?? ?? 33 ?? 89 ?? ?? ?? ?? ?? ?? 5? 5? 5? 5? 8b ?? ",
        "?? ?? ?? ?? ?? 33 ?? 80 3? ?? 8b ?? 75 ?? 80 7? ?? ?? 75 ?? 80 7? ?? ?? c7 44 ",
        "?? ?? ?? ?? ?? ?? 74 ?? 89 ?? ?? ?? 33 ?? 39 ?? ?? ?? 0f 84 ?? ?? ?? ?? b? ?? ",
        "?? ?? ?? 8b ??"
    ))
});
